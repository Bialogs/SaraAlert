{
  "description": "SaraAlertDevFlow",
  "states": [
    {
      "name": "Trigger",
      "type": "InitialState",
      "properties": {
        "offset": {
          "x": 0,
          "y": -30
        },
        "flow_url": "https://webhooks.twilio.com/v1/Accounts/AC5da744a87f534182ecedbc19c472a06b/Flows/FW808f8fe8b3dffc7a413f632dc7088063"
      },
      "transitions": [
        {
          "event": "incomingMessage",
          "conditions": [],
          "next": null,
          "uuid": "b097ac74-7d13-4ca3-bd1e-3cbf0e181bff"
        },
        {
          "event": "incomingCall",
          "conditions": [],
          "next": null,
          "uuid": "08d55e3f-6fc9-42e5-b562-c0b8f0696151"
        },
        {
          "event": "incomingRequest",
          "conditions": [],
          "next": "FFf7aec2bf1eefc48abdfccd68596ac826",
          "uuid": "6432a62e-a4e7-4f75-97a2-ae50cbcc73a6"
        }
      ],
      "sid": "FF16008cb7b1ddffb2d27e5b6dde48c30a"
    },
    {
      "name": "sms_assessment_prompt",
      "type": "MessagePrompt",
      "properties": {
        "offset": {
          "x": 120,
          "y": 550
        },
        "body": "{{flow.data.prompt}}",
        "from": "{{flow.channel.address}}",
        "timeout": 64800,
        "save_response_as": null,
        "media_url": null,
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "attributes": null
      },
      "transitions": [
        {
          "event": "incomingMessage",
          "conditions": [],
          "next": "FF380c2112d24ace950e2ef35a5cd381ae",
          "uuid": "0c66cc6a-4d30-403a-a127-4150d1bde950"
        },
        {
          "event": "timeout",
          "conditions": [],
          "next": "FF618298ce7adfcc8f9833c3a196dadea6",
          "uuid": "61927fd7-b3c1-4618-8f53-5e244ef0d648"
        },
        {
          "event": "deliveryFailure",
          "conditions": [],
          "next": "FF24b04845268fc0f1d6a4dcb9e63d99eb",
          "uuid": "44508609-6602-450d-90ec-ef56fd3b48f9"
        }
      ],
      "sid": "FF2c4b25df6abe968be2f86418ae6e0874"
    },
    {
      "name": "send_assessment_data",
      "type": "Webhook",
      "properties": {
        "offset": {
          "x": 250,
          "y": 1560
        },
        "method": "POST",
        "url": "https://webhook.site/32c9580f-2071-4941-9f81-41c64d89d72c",
        "body": "{\"response_status\": \"success_sms\", \n\"experiencing_symptoms\":\"{{widgets.sms_assessment_prompt.inbound.Body}}\", \"patient_submission_token\": \"{{flow.data.patient_submission_token}}\",\n\"threshold_hash\": \"{{flow.data.threshold_hash}}\"}",
        "timeout": null,
        "parameters": null,
        "save_response_as": null,
        "content_type": "application/json;charset=utf-8"
      },
      "transitions": [
        {
          "event": "success",
          "conditions": [],
          "next": "FFf365befdecfd11e0ccf788e27946d979",
          "uuid": "83204955-9bec-4278-8691-e749f9e427aa"
        },
        {
          "event": "failed",
          "conditions": [],
          "next": null,
          "uuid": "b796f15e-835c-4bc1-9ce7-10114fbdc342"
        }
      ],
      "sid": "FF9fb760e515a78d87351093be14314ad4"
    },
    {
      "name": "check_yes_no",
      "type": "Branch",
      "properties": {
        "offset": {
          "x": 130,
          "y": 850
        },
        "input": "{{widgets.sms_assessment_prompt.inbound.Body}}"
      },
      "transitions": [
        {
          "event": "noMatch",
          "conditions": [],
          "next": "FFbbb0e9c92951108c6d1f1171204f4067",
          "uuid": "341295be-4bd9-42c7-b0dd-858f4cd37e6a"
        },
        {
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of yes,Yes,no,No",
              "type": "matches_any_of",
              "arguments": [
                "{{widgets.sms_assessment_prompt.inbound.Body}}"
              ],
              "value": "yes,Yes,no,No,YES,NO,Yes.,No."
            }
          ],
          "next": "FF9fb760e515a78d87351093be14314ad4",
          "uuid": "fb1eb18a-3d4a-458e-993c-c52712bf64e6"
        }
      ],
      "sid": "FF380c2112d24ace950e2ef35a5cd381ae"
    },
    {
      "name": "bad_response",
      "type": "MessagePrompt",
      "properties": {
        "offset": {
          "x": -670,
          "y": 1100
        },
        "body": "We did not understand your response, please respond with Yes or No.",
        "from": "{{flow.channel.address}}",
        "timeout": 3600,
        "save_response_as": null,
        "media_url": null,
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "attributes": null
      },
      "transitions": [
        {
          "event": "incomingMessage",
          "conditions": [],
          "next": "FFe439ce712c0212597be23e1803ac2738",
          "uuid": "731228fa-c1a1-48ec-a54e-8ea20c1e0f7a"
        },
        {
          "event": "timeout",
          "conditions": [],
          "next": "FF618298ce7adfcc8f9833c3a196dadea6",
          "uuid": "3dbb2f50-115d-4956-9be4-a01e2fb1c134"
        },
        {
          "event": "deliveryFailure",
          "conditions": [],
          "next": "FF24b04845268fc0f1d6a4dcb9e63d99eb",
          "uuid": "a2f33aa6-e7de-4db4-ba13-8d352d10855d"
        }
      ],
      "sid": "FFbbb0e9c92951108c6d1f1171204f4067"
    },
    {
      "name": "send_message_1",
      "type": "Message",
      "properties": {
        "offset": {
          "x": 100,
          "y": 2000
        },
        "body": "Thank you for completing your daily report!",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "media_url": null,
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "attributes": null
      },
      "transitions": [
        {
          "event": "sent",
          "conditions": [],
          "next": null,
          "uuid": "a7fcc59f-000f-4dd0-87ba-2d6edaa18c89"
        },
        {
          "event": "failed",
          "conditions": [],
          "next": null,
          "uuid": "c22f40e5-b70f-4ee6-bd03-733ee80be003"
        }
      ],
      "sid": "FFf365befdecfd11e0ccf788e27946d979"
    },
    {
      "name": "check_yes_no_again",
      "type": "Branch",
      "properties": {
        "offset": {
          "x": -270,
          "y": 1310
        },
        "input": "{{widgets.bad_response.inbound.Body}}"
      },
      "transitions": [
        {
          "event": "noMatch",
          "conditions": [],
          "next": "FFbbb0e9c92951108c6d1f1171204f4067",
          "uuid": "00c020c6-b34b-4c3a-b526-42d8501d8f10"
        },
        {
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of yes,Yes,no,No",
              "type": "matches_any_of",
              "arguments": [
                "{{widgets.bad_response.inbound.Body}}"
              ],
              "value": "yes,Yes,no,No,YES,NO,Yes.,No."
            }
          ],
          "next": "FF80363aa634a8a8793c85961ca963edf4",
          "uuid": "46f2d92c-dc5a-41ed-a7fd-82beb77774f8"
        }
      ],
      "sid": "FFe439ce712c0212597be23e1803ac2738"
    },
    {
      "name": "send_assessment_data_from_sms_retry",
      "type": "Webhook",
      "properties": {
        "offset": {
          "x": -60,
          "y": 1560
        },
        "method": "POST",
        "url": "https://webhook.site/32c9580f-2071-4941-9f81-41c64d89d72c",
        "body": "{\"response_status\": \"success_sms\", \n\"experiencing_symptoms\":\"{{widgets.bad_response.inbound.Body}}\", \"patient_submission_token\": \"{{flow.data.patient_submission_token}}\",\n\"threshold_hash\": \"{{flow.data.threshold_hash}}\"}",
        "timeout": null,
        "parameters": null,
        "save_response_as": null,
        "content_type": "application/json;charset=utf-8"
      },
      "transitions": [
        {
          "event": "success",
          "conditions": [],
          "next": "FFf365befdecfd11e0ccf788e27946d979",
          "uuid": "a1194561-b500-40f3-8e73-5c72c9264147"
        },
        {
          "event": "failed",
          "conditions": [],
          "next": null,
          "uuid": "1b793066-705e-4b68-95b7-8c8c68199b00"
        }
      ],
      "sid": "FF80363aa634a8a8793c85961ca963edf4"
    },
    {
      "name": "sms_or_voice",
      "type": "Branch",
      "properties": {
        "offset": {
          "x": 260,
          "y": 170
        },
        "input": "{{flow.data.medium}}"
      },
      "transitions": [
        {
          "event": "noMatch",
          "conditions": [],
          "next": null,
          "uuid": "f582baeb-c08c-4519-b25b-acc724d76724"
        },
        {
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to SMS",
              "type": "equal_to",
              "arguments": [
                "{{flow.data.medium}}"
              ],
              "value": "SMS"
            }
          ],
          "next": "FF2c4b25df6abe968be2f86418ae6e0874",
          "uuid": "2d2df2e5-ccb9-44f9-8fde-6ba71fb3d654"
        },
        {
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to VOICE",
              "type": "equal_to",
              "arguments": [
                "{{flow.data.medium}}"
              ],
              "value": "VOICE"
            }
          ],
          "next": "FFb013f8c9016772d3c0e326414515b61c",
          "uuid": "bf13be6d-3e38-48dc-923c-914f88796e9e"
        }
      ],
      "sid": "FFf7aec2bf1eefc48abdfccd68596ac826"
    },
    {
      "name": "call_user",
      "type": "DialV2",
      "properties": {
        "offset": {
          "x": 1050,
          "y": 570
        },
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "record": false,
        "recording_channels": "mono",
        "recording_status_callback": null,
        "trim": "do-not-trim",
        "detect_answering_machine": true,
        "machine_detection": "Enable",
        "machine_detection_timeout": "30",
        "machine_detection_speech_threshold": "2400",
        "machine_detection_speech_end_threshold": "1200",
        "machine_detection_silence_timeout": "5000",
        "send_digits": null,
        "timeout": 60,
        "sip_auth_username": null,
        "sip_auth_password": null
      },
      "transitions": [
        {
          "event": "answered",
          "conditions": [],
          "next": "FF4709dfaa8038e994b978fbaf1a2c59f9",
          "uuid": "323d7e76-2803-454d-a70a-2b9bde18c95d"
        },
        {
          "event": "busy",
          "conditions": [],
          "next": "FFf9e8c1cbab27261e39431f7443bba4b6",
          "uuid": "d0f1b8f9-82a7-43b4-b4d3-b07ebd72459f"
        },
        {
          "event": "noAnswer",
          "conditions": [],
          "next": "FFf9e8c1cbab27261e39431f7443bba4b6",
          "uuid": "3d4bd694-4aa2-48f2-8310-db886ad14fe6"
        },
        {
          "event": "failed",
          "conditions": [],
          "next": "FFc9ef9fc327f055e4a8aa2c262e3da0af",
          "uuid": "debab7cd-e549-4581-8172-51b3173d961a"
        }
      ],
      "sid": "FFb013f8c9016772d3c0e326414515b61c"
    },
    {
      "name": "welcome_prompt",
      "type": "SayPlay",
      "properties": {
        "offset": {
          "x": 1050,
          "y": 1120
        },
        "say": "Hello, this is Sara, the automated public health assistant calling for your daily report.",
        "play": null,
        "voice": "Polly.Joanna",
        "language": "en-US",
        "loop": 1,
        "digits": null
      },
      "transitions": [
        {
          "event": "audioComplete",
          "conditions": [],
          "next": "FF331f493715ccd46c7feb4ea3b0f3043c",
          "uuid": "27bac15a-f794-412d-9d8c-493cf75677cf"
        }
      ],
      "sid": "FF6e1ecf24e7c79c0285a590186072fe81"
    },
    {
      "name": "voice_reply_to_prompt",
      "type": "Gather",
      "properties": {
        "offset": {
          "x": 1090,
          "y": 1340
        },
        "timeout": 8,
        "finish_on_key": "#",
        "stop_gather": true,
        "number_of_digits": null,
        "save_response_as": null,
        "say": "{{flow.data.prompt}}",
        "play": null,
        "voice": "Polly.Joanna",
        "language": "en-US",
        "loop": 1,
        "hints": null,
        "gather_language": "en-US",
        "speech_timeout": "auto",
        "speech_model": null,
        "profanity_filter": "true"
      },
      "transitions": [
        {
          "event": "keypress",
          "conditions": [],
          "next": null,
          "uuid": "49a92b19-3887-4c9d-809f-e5e7c019931d"
        },
        {
          "event": "speech",
          "conditions": [],
          "next": "FF3f713f5d60779d9473915e11e56130fa",
          "uuid": "c2b18e53-d16e-4315-809d-9fa0ceee9e26"
        },
        {
          "event": "timeout",
          "conditions": [],
          "next": "FF6d7351c7d1280f35e6c9664648cbaa22",
          "uuid": "75ae29e7-d9a3-4864-8f38-55f266275afd"
        }
      ],
      "sid": "FF331f493715ccd46c7feb4ea3b0f3043c"
    },
    {
      "name": "check_yes_no_voice",
      "type": "Branch",
      "properties": {
        "offset": {
          "x": 1220,
          "y": 1640
        },
        "input": "{{widgets.voice_reply_to_prompt.SpeechResult}}"
      },
      "transitions": [
        {
          "event": "noMatch",
          "conditions": [],
          "next": "FF6d7351c7d1280f35e6c9664648cbaa22",
          "uuid": "d3b4361f-cbab-45f8-bfca-155663f5f996"
        },
        {
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value matches_any_of yes,Yes,no,No",
              "type": "matches_any_of",
              "arguments": [
                "{{widgets.voice_reply_to_prompt.SpeechResult}}"
              ],
              "value": "yes,Yes,no,No,Yes.,No.,Yeah,yeah,Yeah."
            }
          ],
          "next": "FF4232968feb3ce800048625da08d70e1a",
          "uuid": "608e2cba-8089-4f23-afad-2502a0c86b9d"
        }
      ],
      "sid": "FF3f713f5d60779d9473915e11e56130fa"
    },
    {
      "name": "voice_send_assessment_data",
      "type": "Webhook",
      "properties": {
        "offset": {
          "x": 1430,
          "y": 2000
        },
        "method": "POST",
        "url": "https://webhook.site/32c9580f-2071-4941-9f81-41c64d89d72c",
        "body": "{\"response_status\":\"success_voice\", \n\"experiencing_symptoms\":\"{{widgets.voice_reply_to_prompt.SpeechResult}}\", \"patient_submission_token\": \"{{flow.data.patient_submission_token}}\",\n\"threshold_hash\": \"{{flow.data.threshold_hash}}\"}",
        "timeout": null,
        "parameters": null,
        "save_response_as": null,
        "content_type": "application/json;charset=utf-8"
      },
      "transitions": [
        {
          "event": "success",
          "conditions": [],
          "next": "FF8fd0c59db3de52d1054c033575298bc0",
          "uuid": "622d3025-e054-4450-955c-175ebd743019"
        },
        {
          "event": "failed",
          "conditions": [],
          "next": null,
          "uuid": "026eac20-b271-4fee-ad46-8af1b69d3a10"
        }
      ],
      "sid": "FF4232968feb3ce800048625da08d70e1a"
    },
    {
      "name": "thank_you_voice",
      "type": "SayPlay",
      "properties": {
        "offset": {
          "x": 1440,
          "y": 2380
        },
        "say": "Thank you for completing your daily report! Goodbye.",
        "play": null,
        "voice": "Polly.Joanna",
        "language": "en-US",
        "loop": 1,
        "digits": null
      },
      "transitions": [
        {
          "event": "audioComplete",
          "conditions": [],
          "next": null,
          "uuid": "8ee614cf-9746-4922-bb8e-7087bf1acaf3"
        }
      ],
      "sid": "FF8fd0c59db3de52d1054c033575298bc0"
    },
    {
      "name": "say_lets_try_again",
      "type": "SayPlay",
      "properties": {
        "offset": {
          "x": 1690,
          "y": 1340
        },
        "say": "I'm sorry, I didn't quite get that. Let's try again.",
        "play": null,
        "voice": "Polly.Joanna",
        "language": "en-US",
        "loop": 1,
        "digits": null
      },
      "transitions": [
        {
          "event": "audioComplete",
          "conditions": [],
          "next": "FF331f493715ccd46c7feb4ea3b0f3043c",
          "uuid": "083d1a50-e004-4e17-8286-be1dfef65ee8"
        }
      ],
      "sid": "FF6d7351c7d1280f35e6c9664648cbaa22"
    },
    {
      "name": "voice_send_no_answer",
      "type": "Webhook",
      "properties": {
        "offset": {
          "x": 1550,
          "y": 910
        },
        "method": "POST",
        "url": "https://webhook.site/32c9580f-2071-4941-9f81-41c64d89d72c",
        "body": "{\"response_status\":\"no_answer_voice\", \"patient_submission_token\": \"{{flow.data.patient_submission_token}}\",\n\"threshold_hash\": \"{{flow.data.threshold_hash}}\"}",
        "timeout": null,
        "parameters": null,
        "save_response_as": null,
        "content_type": "application/json;charset=utf-8"
      },
      "transitions": [
        {
          "event": "success",
          "conditions": [],
          "next": null,
          "uuid": "acbed993-69a2-4bd6-aece-05181308768c"
        },
        {
          "event": "failed",
          "conditions": [],
          "next": null,
          "uuid": "60cd6b1f-c462-4191-ba2f-3ee8046e7000"
        }
      ],
      "sid": "FFf9e8c1cbab27261e39431f7443bba4b6"
    },
    {
      "name": "split_1",
      "type": "Branch",
      "properties": {
        "offset": {
          "x": 870,
          "y": 850
        },
        "input": "{{widgets.call_user.AnsweredBy}}"
      },
      "transitions": [
        {
          "event": "noMatch",
          "conditions": [],
          "next": "FFf9e8c1cbab27261e39431f7443bba4b6",
          "uuid": "a1d94d2e-82d3-4165-a49e-7824534cb907"
        },
        {
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to human",
              "type": "equal_to",
              "arguments": [
                "{{widgets.call_user.AnsweredBy}}"
              ],
              "value": "human"
            }
          ],
          "next": "FF6e1ecf24e7c79c0285a590186072fe81",
          "uuid": "1e42afb6-071f-412f-8456-4e9247795acf"
        }
      ],
      "sid": "FF4709dfaa8038e994b978fbaf1a2c59f9"
    },
    {
      "name": "send_assessment_sms_no_response",
      "type": "Webhook",
      "properties": {
        "offset": {
          "x": -380,
          "y": 780
        },
        "method": "POST",
        "url": "https://webhook.site/32c9580f-2071-4941-9f81-41c64d89d72c",
        "body": "{\"response_status\":\"no_answer_sms\", \n\"patient_submission_token\": \"{{flow.data.patient_submission_token}}\",\n\"threshold_hash\": \"{{flow.data.threshold_hash}}\"}",
        "timeout": null,
        "parameters": null,
        "save_response_as": null,
        "content_type": "application/json;charset=utf-8"
      },
      "transitions": [
        {
          "event": "success",
          "conditions": [],
          "next": null,
          "uuid": "6e923eed-31c7-4e69-b280-2ebb2979381e"
        },
        {
          "event": "failed",
          "conditions": [],
          "next": null,
          "uuid": "5167b681-de3a-42b9-990e-83cd69901049"
        }
      ],
      "sid": "FF618298ce7adfcc8f9833c3a196dadea6"
    },
    {
      "name": "send_assessment_sms_error",
      "type": "Webhook",
      "properties": {
        "offset": {
          "x": -1270,
          "y": 1320
        },
        "method": "POST",
        "url": "https://webhook.site/32c9580f-2071-4941-9f81-41c64d89d72c",
        "body": "{\"response_status\":\"error_sms\", \n\"patient_submission_token\": \"{{flow.data.patient_submission_token}}\",\n\"threshold_hash\": \"{{flow.data.threshold_hash}}\"}",
        "timeout": null,
        "parameters": null,
        "save_response_as": null,
        "content_type": "application/json;charset=utf-8"
      },
      "transitions": [
        {
          "event": "success",
          "conditions": [],
          "next": null,
          "uuid": "1b34a015-729d-4c48-83e9-bedc1ca21fea"
        },
        {
          "event": "failed",
          "conditions": [],
          "next": null,
          "uuid": "c7f1e509-0500-4555-98ce-2e9674bf2b9b"
        }
      ],
      "sid": "FF24b04845268fc0f1d6a4dcb9e63d99eb"
    },
    {
      "name": "voice_send_error",
      "type": "Webhook",
      "properties": {
        "offset": {
          "x": 1910,
          "y": 910
        },
        "method": "POST",
        "url": "https://webhook.site/32c9580f-2071-4941-9f81-41c64d89d72c",
        "body": "{\"response_status\":\"error_voice\", \"patient_submission_token\": \"{{flow.data.patient_submission_token}}\",\n\"threshold_hash\": \"{{flow.data.threshold_hash}}\"}",
        "timeout": null,
        "parameters": null,
        "save_response_as": null,
        "content_type": "application/json;charset=utf-8"
      },
      "transitions": [
        {
          "event": "success",
          "conditions": [],
          "next": null,
          "uuid": "a2b88c4b-28f6-4980-a12e-7de15e60c6f1"
        },
        {
          "event": "failed",
          "conditions": [],
          "next": null,
          "uuid": "4ad1b312-1411-498f-98f6-c5a02a419b7d"
        }
      ],
      "sid": "FFc9ef9fc327f055e4a8aa2c262e3da0af"
    }
  ]
}